<!-- Rent vs Buy Calculator (Shopify Inline Embed) -->

<!-- Inline Styles -->
<style>
    /* Rent vs Buy Calculator Styles */
    body, .rentbuy-root {
        font-family: system-ui, Arial, sans-serif;
        background: #f8f9fa;
        margin: 0;
        padding: 0;
    }
    .rentbuy-root {
        max-width: 420px;
        margin: 2rem auto;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        padding: 2rem 1.5rem;
    }
    .rentbuy-root h1 {
        font-size: 1.5rem;
        margin-bottom: 1.5rem;
        text-align: center;
    }
    .rentbuy-form-group {
        margin-bottom: 1.1rem;
    }
    .rentbuy-root label {
        display: block;
        margin-bottom: 0.3rem;
        font-weight: 500;
    }
    .rentbuy-root input[type="number"] {
        width: 100%;
        padding: 0.5rem;
        border: 1px solid #d1d5db;
        border-radius: 5px;
        font-size: 1rem;
        box-sizing: border-box;
    }
    .rentbuy-root button[type="submit"] {
        width: 100%;
        padding: 0.7rem;
        background: #2563eb;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        margin-top: 0.5rem;
        transition: background 0.2s;
    }
    .rentbuy-root button[type="submit"]:hover {
        background: #1e40af;
    }
    .rentbuy-results-section {
        margin-top: 2rem;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 8px;
        text-align: center;
    }
    .rentbuy-results-summary > div {
        margin-bottom: 0.7rem;
        font-size: 1.1rem;
    }
    .rentbuy-bar-chart {
        margin-top: 1.2rem;
        height: 120px;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        gap: 2rem;
    }
    @media (max-width: 600px) {
        .rentbuy-root {
            padding: 1rem 0.5rem;
        }
        .rentbuy-root h1 {
            font-size: 1.1rem;
        }
    }
    </style>
    
    <!-- Calculator Markup -->
    <div class="rentbuy-root" id="rentbuy-root">
        <h1>Rent vs Buy Calculator</h1>
        <form id="rentbuy-form">
            <div class="rentbuy-form-group">
                <label for="rentbuy-rent">Monthly Rent ($)</label>
                <input type="number" id="rentbuy-rent" min="0" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-homePrice">Home Price ($)</label>
                <input type="number" id="rentbuy-homePrice" min="0" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-downPayment">Down Payment (%)</label>
                <input type="number" id="rentbuy-downPayment" min="0" max="100" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-mortgageRate">Mortgage Rate (Annual %)</label>
                <input type="number" id="rentbuy-mortgageRate" min="0" step="0.01" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-amortization">Amortization Period (years)</label>
                <input type="number" id="rentbuy-amortization" min="1" max="35" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-propertyTax">Property Tax Rate (%)</label>
                <input type="number" id="rentbuy-propertyTax" min="0" step="0.01" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-appreciation">Annual Home Appreciation (%)</label>
                <input type="number" id="rentbuy-appreciation" min="-10" max="20" step="0.01" required>
            </div>
            <div class="rentbuy-form-group">
                <label for="rentbuy-years">Expected Years in Home</label>
                <input type="number" id="rentbuy-years" min="1" max="50" required>
            </div>
            <button type="submit">Calculate</button>
        </form>
        <div id="rentbuy-results" class="rentbuy-results-section" style="display:none;">
            <h2>Results</h2>
            <div class="rentbuy-results-summary">
                <div id="rentbuy-rentTotal"></div>
                <div id="rentbuy-buyTotal"></div>
                <div id="rentbuy-recommendation"></div>
            </div>
            <div id="rentbuy-barChart" class="rentbuy-bar-chart"></div>
        </div>
    </div>
    
    <!-- Inline Script -->
    <script>
    (function() {
        // Get DOM elements (scoped to avoid conflicts)
        var root = document.getElementById('rentbuy-root');
        var form = document.getElementById('rentbuy-form');
        var resultsSection = document.getElementById('rentbuy-results');
        var rentTotalDiv = document.getElementById('rentbuy-rentTotal');
        var buyTotalDiv = document.getElementById('rentbuy-buyTotal');
        var recommendationDiv = document.getElementById('rentbuy-recommendation');
        var barChartDiv = document.getElementById('rentbuy-barChart');
    
        // Helper: Calculate monthly mortgage payment (fixed-rate, Canadian style)
        function calcMonthlyMortgage(P, annualRate, years) {
            var n = years * 12;
            var r = annualRate / 100 / 12;
            if (r === 0) return P / n;
            return P * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
        }
        // Helper: Calculate total rent cost
        function calcTotalRent(monthlyRent, years) {
            return monthlyRent * 12 * years;
        }
        // Helper: Calculate total buy cost
        function calcTotalBuy(params) {
            var homePrice = params.homePrice;
            var downPaymentPct = params.downPaymentPct;
            var mortgageRate = params.mortgageRate;
            var amortization = params.amortization;
            var propertyTaxRate = params.propertyTaxRate;
            var appreciation = params.appreciation;
            var years = params.years;
            var downPayment = homePrice * (downPaymentPct / 100);
            var mortgageAmount = homePrice - downPayment;
            var monthlyPayment = calcMonthlyMortgage(mortgageAmount, mortgageRate, amortization);
            var months = years * 12;
            var totalMortgagePayments = monthlyPayment * months;
            var propertyTax = homePrice * (propertyTaxRate / 100) * years;
            var futureHomeValue = homePrice * Math.pow(1 + appreciation / 100, years);
            // Estimate principal repaid
            var principalRepaid = 0;
            var balance = mortgageAmount;
            for (var i = 0; i < months; i++) {
                var interest = balance * (mortgageRate / 100 / 12);
                var principal = monthlyPayment - interest;
                principalRepaid += principal;
                balance -= principal;
                if (balance < 0) break;
            }
            var netCost = downPayment + totalMortgagePayments + propertyTax - (futureHomeValue - homePrice) - principalRepaid;
            return {
                netCost: netCost,
                downPayment: downPayment,
                totalMortgagePayments: totalMortgagePayments,
                propertyTax: propertyTax,
                futureHomeValue: futureHomeValue,
                principalRepaid: principalRepaid
            };
        }
        // Helper: Format currency
        function formatCurrency(num) {
            return '$' + Math.round(num).toLocaleString('en-CA');
        }
        // Draw simple bar chart
        function drawBarChart(rentCost, buyCost) {
            barChartDiv.innerHTML = '';
            var max = Math.max(rentCost, buyCost);
            var rentHeight = max ? Math.round((rentCost / max) * 100) : 0;
            var buyHeight = max ? Math.round((buyCost / max) * 100) : 0;
            // Rent bar
            var rentBar = document.createElement('div');
            rentBar.style.height = rentHeight + 'px';
            rentBar.style.width = '60px';
            rentBar.style.background = '#2563eb';
            rentBar.style.borderRadius = '6px 6px 0 0';
            rentBar.title = 'Total Rent';
            rentBar.style.display = 'flex';
            rentBar.style.alignItems = 'flex-end';
            rentBar.style.justifyContent = 'center';
            rentBar.innerHTML = '<span style="color:#fff;font-size:0.9rem;position:relative;top:-22px;">' + formatCurrency(rentCost) + '</span>';
            // Buy bar
            var buyBar = document.createElement('div');
            buyBar.style.height = buyHeight + 'px';
            buyBar.style.width = '60px';
            buyBar.style.background = '#10b981';
            buyBar.style.borderRadius = '6px 6px 0 0';
            buyBar.title = 'Total Buy';
            buyBar.style.display = 'flex';
            buyBar.style.alignItems = 'flex-end';
            buyBar.style.justifyContent = 'center';
            buyBar.innerHTML = '<span style="color:#fff;font-size:0.9rem;position:relative;top:-22px;">' + formatCurrency(buyCost) + '</span>';
            // Labels
            var rentLabel = document.createElement('div');
            rentLabel.style.textAlign = 'center';
            rentLabel.style.marginTop = '4px';
            rentLabel.textContent = 'Rent';
            var buyLabel = document.createElement('div');
            buyLabel.style.textAlign = 'center';
            buyLabel.style.marginTop = '4px';
            buyLabel.textContent = 'Buy';
            // Bar containers
            var rentContainer = document.createElement('div');
            rentContainer.appendChild(rentBar);
            rentContainer.appendChild(rentLabel);
            var buyContainer = document.createElement('div');
            buyContainer.appendChild(buyBar);
            buyContainer.appendChild(buyLabel);
            // Add to chart
            barChartDiv.appendChild(rentContainer);
            barChartDiv.appendChild(buyContainer);
        }
        // Handle form submission
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            var monthlyRent = Number(document.getElementById('rentbuy-rent').value);
            var homePrice = Number(document.getElementById('rentbuy-homePrice').value);
            var downPaymentPct = Number(document.getElementById('rentbuy-downPayment').value);
            var mortgageRate = Number(document.getElementById('rentbuy-mortgageRate').value);
            var amortization = Number(document.getElementById('rentbuy-amortization').value);
            var propertyTaxRate = Number(document.getElementById('rentbuy-propertyTax').value);
            var appreciation = Number(document.getElementById('rentbuy-appreciation').value);
            var years = Number(document.getElementById('rentbuy-years').value);
            var totalRent = calcTotalRent(monthlyRent, years);
            var buy = calcTotalBuy({
                homePrice: homePrice,
                downPaymentPct: downPaymentPct,
                mortgageRate: mortgageRate,
                amortization: amortization,
                propertyTaxRate: propertyTaxRate,
                appreciation: appreciation,
                years: years
            });
            resultsSection.style.display = 'block';
            rentTotalDiv.textContent = 'Total Rent Cost: ' + formatCurrency(totalRent);
            buyTotalDiv.textContent = 'Total Buy Cost: ' + formatCurrency(buy.netCost);
            var rec = '';
            if (totalRent < buy.netCost) {
                rec = 'Better to Rent';
            } else if (buy.netCost < totalRent) {
                rec = 'Better to Buy';
            } else {
                rec = 'Costs are about the same';
            }
            recommendationDiv.textContent = 'Recommendation: ' + rec;
            drawBarChart(totalRent, buy.netCost);
        });
    })();
    </script> 